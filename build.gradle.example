apply plugin: 'groovy'

String discordGVersion = "2.0.0"

def downloadDiscordG = {
	return new File("libs/${discordGVersion}.jar").with {
		createNewFile()
		mkdirs()
		delegate
	}.withOutputStream { out ->
		out << new URL("https://github.com/hlaaftana/DiscordG/releases/download/${discordGVersion}/DiscordG-${discordGVersion}.jar").openStream()
		delegate
	}
}

jar {
    from { configurations.compile.findAll { !it.path.contains("groovy") }.collect { it.directory ? it : zipTree(it) } }
}

repositories {
    mavenCentral()
}

dependencies {
	downloadDiscordG
	compile 'org.codehaus.groovy:groovy-all:2.4.5'
	compile files("libs/DiscordG-${discordGVersion}.jar")
}

version = "1"
group = "my.cool.program"
archivesBaseName = "AwesomeStuff"